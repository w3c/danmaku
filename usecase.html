<!DOCTYPE html>
<html lang="en">

<head>
  <title>Bullet Chatting Use Cases</title>
  <meta charset='utf-8'>
  <link rel="stylesheet" href="./local.css" />
  <script src='https://www.w3.org/Tools/respec/respec-w3c' async class='remove'></script>
  <script class='remove'>
    var respecConfig = {
      specStatus: "CG-DRAFT",
      edDraftURI: "https://w3c.github.io/danmaku/usecase.html",
      shortName: "danmaku",
      editors: [{
        name: "Zhihao Huang",
        companyURL: "https://www.bilibili.com/",
        company: "‎Bilibili Inc."

      }, {
        name: "Song Xu",
        companyURL: 'http://www.migu.cn',
        company: "China Mobile"

      },{
        name: "Fuqiao Xue",
        companyURL: "http://www.chinaw3c.org/",
        company: "W3C"
      }, {
        name: "Lei Zhao",
        companyURL: "http://www.migu.cn",
        company: "China Mobile"
      }, {
        name: "Zhaoxin Tan",
        companyURL: "https://www.bilibili.com/",
        company: "Bilibili Inc."
      }, {
        name: "Yajun Chen",
        companyURL: 'http://www.migu.cn',
        company: "China Mobile"
      }],
      wg: "Bullet Chatting Community Group",
      wgURI: "https://www.w3.org/community/bullet-chatting/",
      github: {
        repoURL: "https://github.com/w3c/danmaku",
        branch: "master"
      },
    };
  </script>
</head>

<body>
  <section id='abstract'>
    <p>
      This document describes use cases and requirements for Danmaku.
    </p>
  </section>
   <section id='sotd'>
    <p>
      This is still a work in progress. The proposal is being incubated in the <a href="https://www.w3.org/community/bullet-chatting/">W3C Bullet Chatting Community Group</a>.
    </p>
  </section>
  <section>
    <h2>Introduction</h2>
    <p>
      To create more immersive media experiences, many video-sharing platforms embed social mechanisms that allow users to share comments and view others' comments at specific points in a media timeline. One of these mechanisms is <a>bullet chatting</a>, also known as <em>danmaku</em> (<span lang="ja">弾幕</span>) in Japanese, where a possibly large number of comments and annotations get rendered and animated as video overlays during playback (see <a href="#fig-an-example-of-bullet-chatting"></a>).
    </p>
    <p>
      <a>Bullet chatting</a> was first introduced by the Japanese video-sharing website Niconico (<span lang="ja">ニコニコ</span>). In China, besides use in video-sharing websites such as Bilibili and AcFun, <a>bullet chatting</a> is also supported by video players embedded in main video websites such as Tencent video, iQiyi video, Youku video and Migu video (see <a href="#commercial"></a>).
    </p>
    <figure id="fig-an-example-of-bullet-chatting">
      <img alt="Example of bullet chatting" src="images/danmaku.png" width="600">
      <figcaption>
        An example of bullet chatting
      </figcaption>
    </figure>
    <section>
      <h2>Bullet Chatting attributes</h2>
      <p>
        A <a>bullet chatting comment</a> can be described with the following four attributes:
      </p>
      <ul>
        <li>
          <dfn>Mode</dfn>: Rolling Bullet Chatting, reverse Bullet Chatting, top Bullet Chatting, bottom Bullet Chatting.
        </li>
        <li>
          <dfn>Basic properties</dfn>: body, appearance time, duration, font, font size, color, etc.
        </li>
        <li>
          <dfn>Timeline</dfn>: The on-demand barcorder is a real-time insertion or custom timeline for video playback time, live
          broadcasts, and other scenarios.
        </li>
        <li>
          <dfn>Container</dfn>: A block-level element, typically the same size as the video.
        </li>
      </ul>
    </section>

    <section>
      <h2>Bullet Chatting characteristics</h2>
      <p>
        A <a>bullet Chatting</a> experience has three characteristics:
      </p>
      <ul>
        <li>
          <dfn>Independence of space</dfn>: Although displayed in the same element, each <a>mode</a> is in a different <a>layer</a>, and each <a>mode</a> can have multiple <a>layers</a>, and the <a>bullet chatting comments</a> within each <a>layer</a> do not overlap unless there are too many comments to render and overlap is allowed.
        </li>
        <li>
          <dfn>Deterministic of rendering</dfn>: If the Bullet Chatting area and the rendered list are fixed, then the position and
          order of each Bullet Chatting is fixed each time it is rendered.
        </li>
        <li>
          <dfn>Uniformity of modes</dfn>: The survival time of the Bullet Chatting of each mode remains the same.
        </li>
      </ul>
    </section>

    <section id='basic-modes'>
      <h2>Basic modes of the Bullet Chatting</h2>
      <p>
        There are four basic <a>modes</a> for a <a>bullet chatting comment</a>:
      </p>
      <ol>
        <li>
          <dfn>Rolling Bullet Chatting</dfn>: the bullet chat moves from right to left at a constant speed, stacked from top to bottom.
        </li>
        <li>
          <dfn>Reverse Bullet Chatting</dfn>: the bullet chat moves from left to right at a constant speed, stacked from top to bottom. This is contrasted against Rolling Bullet Chatting.
        </li>
        <li>
          <dfn>Top Bullet Chatting</dfn>: A bullet chat that is horizontally and statically centered, stacked from top to bottom.
        </li>
        <li>
          <dfn>Bottom Bullet Chatting</dfn>: A bullet chat that is horizontally and statically centered, stacked from bottom to top.
        </li>
      </ol>
        <p>
          In addition, Bullet Chatting has higher levels of customization and is out of scope for this document.
        </p>
    </section>
  </section>

  <section>
    <h2>Terminology</h2>
      <p>
        This document uses the following terms:
      </p>
      <ul>
        <li>
          <dfn>bullet chatting</dfn> &mdash; an augmentation mechanism for media experiences whereby a usually large number of comments and annotations get rendered and animated in certain ways and at specific points in time on top of a video. By extension, the term is also used to describe similar experiences on top of other types of content (see for example <a href="#interaction-within-a-webpage"></a> and <a href="#interactive-wall"></a>).
        </li>

        <li><dfn>bullet chatting comment</dfn> &mdash; an individual comment or annotation in a <a>bullet chatting</a> experience</li>

        <li><dfn>layer</dfn> &mdash; a set of bullet chatting comment(s) in the same <a>mode</a>. A <a>mode</a> can have multiple layers, and the bullet chatting comment(s) within each layer do not overlap unless there are too many comments to render and overlap is allowed.</li>
      </ul>
  </section>

  <section>
    <h2>Background</h2>
    <section>
      <h2>Analysis from the perspective of user experience</h2>
      <p>During live streaming, two popular text chatting features are often provided to encourage user interaction: Chatroom and Bullet Chatting.</p>
      <figure>
        <img alt="an example of chatroom" src="images/why1.png" width="600">
        <figcaption>
          Chatroom: with the input of text, the content list will be scrolling from the bottom to the top at a constant speed.
        </figcaption>
      </figure>
      <figure>
        <img alt="an example of Bullet Chatting" src="images/why2.png" width="600">
        <figcaption>
          Bullet Chatting: with the input of text, a single line of text will show up from the right side of the video, moving right-to-left in an independent path.
        </figcaption>
      </figure>
      <section>
        <h2>Advantage of displaying with Bullet Chatting</h2>
        <p>We can see from the below figure that when many people are chatting in the same room during live streaming, messages will be scrolling quickly, the display time of each message is highly affected by the chatroom's activity, the more active the users are, the less time each message will be displayed.</p>
        <figure>
          <img alt="the display time of a single message in a chatroom" src="images/why3.png" width="600">
          <figcaption>
            The display time of a single message in a chatroom
          </figcaption>
        </figure>
        <p>Bullet Chatting tries to provide a better way to display each message when many people are chatting online at the same time.</p>
        <ul>
          <li>
            <p>Density of the Information </p>
            <p>Compared to the chatroom, Bullet Chatting has a wider display area, which provides better user experience reading a message even with the same font size.</p>
            <figure>
              <img alt="the display time of a single message in Bullet Chatting" src="images/why4.png" width="600">
              <figcaption>
                a figure of the display time of a single message in Bullet Chatting
              </figcaption>
            </figure>
          </li>
          <li>
            <p>Update Frequency of the Information</p>
            <p>In the Chatroom display mode, each message is scrolling up at the same speed as the others, so it's very difficult to do some special handling. While in the Bullet Chatting mode, each message is moving along their own path, and rarely affected by the update frequency of all the other messages, so it's possible and encouraged to ensure a proper display time for each message by algorithms.</p>
          </li>
          <li>
            <p>Movement of Users' Sight</p>
            <p>In the Chatroom display mode, it's difficult for a user to concentrate on both the video content and the text comments. While in the Bullet Chatting mode, video content is actually covered by the text comments, the user's sight doesn't need to move back and forth across the video and the text messages, so it can provide better immersive experience.
            </p>
            <figure>
              <img alt="Movement of Users' Sight in Chatroom" src="images/why5.png" width="600">
              <figcaption>
                a figure of the movement of users' sight in the Chatroom display mode
              </figcaption>
            </figure>
            <figure>
              <img alt="Movement of Users' Sight in Chatroom in Bullet Chatting" src="images/why6.png" width="600">
              <figcaption>
                a figure of the movement of users' sight in the Bullet Chatting display mode
              </figcaption>
            </figure>
          </li>
          <li>
            <p>Reading Habit</p>
            <p>In a lot of languages, text is read from left to right and from top to bottom, so many people are used to read a single-line message horizontally. In the Bullet Chatting mode, text is mostly moving right-to-left, which allows people to read from left to right, so the user can get the meaning of such message very quickly.
            </p>
            <figure>
              <img alt="direction of reading in Bullet Chatting" src="images/why7.png" width="600">
              <figcaption>
                a figure of the direction of reading in the Bullet Chatting display mode
              </figcaption>
            </figure>
            <p>While in the Chatroom display mode, even the user would like to read from left to right, the text messages are actually moving from bottom to top, which leads a mismatching bevel angle and increases the difficulty for the user to easily scan the comments.</p>
            <figure>
              <img alt="direction of reading in chatroom" src="images/why8.png" width="600">
              <figcaption>
                a figure of the direction of reading in the chatroom display mode
              </figcaption>
            </figure>
          </li>
        </ul>
      </section>
    </section>
    <section>
      <h2>Analysis of the Psychological Factors</h2>
      <p>From the perspective of social psychology, compared to watching a video alone, the feeling of participating in a group activity will make the user more cheerful. Bullet Chatting, by showing the text comments and the video content together in a comfortable way, can create a sense of participation in a group activity to the user. Without leaving his sight from the video content, the user is able to read others' comments on the on-going video clip or the up-coming clip, this helps to increase everyone's social presence.
      </p>
    </section>
  </section>


  <section>
    <h2>Scenarios</h2>
    This section mainly describes the specific use scenarios of Bullet Chatting.
    <section>
      <h2>On-demand video interaction</h2>
      <p>
        When watching a video site to provide a video, the viewer will have some ideas or voicing points in the process
        of watching the video content, and want to publish it to share with more people. At this time, a Bullet Chatting
        is needed to meet this demand. Through the Bullet Chatting, the viewer's comments at the same time can be
        displayed in the video area by scrolling in a fixed direction, or statically displayed at the top or bottom of
        the video area, which can increase the interactive characteristics of the viewer and the video and the viewer.
        Interaction between the two. The Bullet Chatting sent at the same time basically has the same theme.
      </p>
      <figure>
        <img alt="Screenshot of on-demand video interaction" src="images/video-on-demand.png" width="600">
        <figcaption>
          Example of on-demand video interaction
        </figcaption>
      </figure>
      <p>
        In this scenario, the Bullet Chatting data is generally offline data (not real-time), and there is also a small
        amount of real-time data.
      </p>
      <div>
        <p><b>Requirement</b></p>
        <ul>
          <li>
            <b>From the user's point of view:</b> the user needs to input the content of the bullet chat, set the presentation of the bullet chat (including the font size, font color, whether it contains images, the area for displaying it etc.), and the bullet chat should be displayed on the screen in real time after it is being sent.</li>
          <li>
            <b>From the service provider's point of view:</b> the bullet chat sent by the user needs to be displayed over the video. The bullet chat may be sent by a user at a certain time, or in real time. For real-time bullet chatting, it is necessary to associate the data sent in real time with the timeline of the video; it is necessary to save the bullet chat data sent by the user to the server and saved in a database; the bullet chat should be synchronized to other users viewing the video at this moment. For bullet chats saved on the server, the developer needs to get the data of the bullet chat from the server and render it in the specified area. The bullet chat displayed on the web page and on the native app need to be consistent in terms of content and timing.
          </li>
        </ul>
      </div>
    </section>
    <section>
      <h2>Live streaming interaction</h2>
      <p>Bullet Chatting can also be a direct interaction between the anchor and the viewers in the live streaming
        scenario. Compared with the traditional real-time comments, the anchor can understand the
        audience's needs and feedback more intuitively according to the display of the Bullet Chatting on the screen, adjust the next action and processing more conveniently, and can also interact according to the viewers' input.</p>
        <figure>
          <img alt="Live streaming interaction" src="images/video-live.png" width="600">
          <figcaption>
            Example of live streaming interaction: control the game being live streamed by sending bullet chatting commands to vote
          </figcaption>
        </figure>
      <p>
        In this scenario, the Bullet Chatting data is generally real-time data.
      </p>
      <div>
        <p><b>Requirement</b></p>
        <ul>
          <li>
            <b>From the user's point of view:</b> the content of the bullet chat sent by the user should be displayed on the screen in real time.
          </li>
          <li>
            <b>From the service provider's point of view:</b> the bullet chat sent by the user needs to be displayed in real time on both the anchor's and the viewers' screen.
          </li>
        </ul>
      </div>
    </section>
    <section>
      <h2>Identify video highlights</h2>
      <p>
        Since the Bullet Chatting will only appear at a specific point in the video, if there is a large number of
        Bullet Chatting at a certain point in time, it means that the time point has bright spots and high energy. The
        audience is interested in this time point event and can also be used as video management and Recommended
        reference data for other functions.
      </p>
      <figure>
        <img alt="Identify video highlights" src="images/video-highlights.jpeg" width="600">
        <figcaption>
          Example of identifying video highlights: visualize the density or time distriibution of bullet chatting, to identify the highlights of the video
        </figcaption>
      </figure>
      <div>
        <p><b>Requirement</b></p>
        <ul>
          <li>
            <b>From the user's point of view:</b> users can enter the content of the bullet chat at any time, set the presentation style, and display it on the screen in real time after sending it.</li>
          <li>
            <b>From the service provider's point of view:</b> when bullet chatting is enabled, a bullet chatting list needs to be provided to the user. The bullet chat sent by the user needs to be displayed on the video, and the number of bullet chat corresponding to the video timeline needs be visualized and displayed to the user.
          </li>
        </ul>
      </div>
    </section>

    <section>
      <h2>Video content enhancement</h2>
      <p>
        In the process of video on demand or live streaming, there are some stages, the user is not concerned with the
        picture content of the video itself, but the emotions and emotions stimulated by a certain point. At this time,
        the viewer can enhance the video by superimposing on the video by the Bullet Chatting. The effect at this time
        is to achieve a better experience. For example, the victory of the game, the climax of the plot to render the
        atmosphere, or the cover of the horror of the horror to reduce fear.
      </p>
      <figure>
        <img alt="Example of video content enhancement" src="images/content-no-bulletchat.png" width="600">
        <figcaption>
          Example of video content enhancement: screenshot for the horror scene of a horror movie, without bullet chatting
        </figcaption>
      </figure>
      <figure>
        <img alt="Example of video content enhancement" src="images/content.png" width="600">
        <figcaption>
          Example of video content enhancement: screenshot for the horror scene of a horror movie, with bullet chatting
        </figcaption>
      </figure>
      <div>
        <p><b>Requirement</b></p>
        <ul>
          <li>
            <b>From the user's point of view:</b> the user should be able to turn on or off the bullet chatting function.</li>
          <li>
            <b>From the service provider's point of view:</b> when bullet chatting is enabled, a bullet chatting list needs to be provided to the user. Display the bullet chat when the video reaches the time corresponding to the time the bullet chat was sent.
          </li>
        </ul>
      </div>
    </section>
    <section>
      <h2>Interaction within a webpage</h2>
      <p>
        Sometimes in order to increase the effect of a webpage, the product operator hopes to make the relevant content
        into a visual impact of the Bullet Chatting effect, so that the relevant activities can be promoted in the webpage to increase the impact of the page, attracting The attention of young people increases the income.
      </p>
      <p>
        In this kind of scenario, the Bullet Chatting is displayed separately and is not attached to the video.
      </p>
      <figure>
        <img alt="Interaction within a webpage" src="images/web_bulletchat.png" width="600">
        <figcaption>
          Example of interaction within a webpage: discussion on specific content in the webpage
        </figcaption>
      </figure>

      <div>
        <p><b>Requirement</b></p>
        <ul>
          <li>
            <b>From the user's point of view:</b> the user needs to input the content of the bullet chat, set the presentation of the bullet chat (including the font size, font color, whether it contains images, the area for displaying it etc.), and the bullet chat should be displayed on the screen in real time after it is being sent.
          </li>
          <li>
            <b>From the service provider's point of view:</b> the bullet chat may be sent by a user at a certain time, or in real time. For real-time bullet chatting, it is necessary to display the bullet chat in real time; it is necessary to save the bullet chat data sent by the user to the server and saved in a database; the bullet chat should be synchronized to other users viewing this page at this moment. For bullet chats saved on the server, the developer needs to get the data of the bullet chat from the server and render it in the specified area.
          </li>
        </ul>
      </div>
    </section>
    <section>
      <h2>Interactive wall</h2>
      <p>
        In this scenario, the user can send the content of the Bullet Chatting to the display <i>wall</i> in an offline event. The wall can be a pure Bullet Chatting application, without any video or other content on the big screen. The wall only shows the discussions at the venue or online, and enhances the event atmosphere to make participants have a stronger sense of participation.
      </p>
      <figure>
        <img alt="Interactive wall" src="images/bulletchat-wall.png" width="600">
        <figcaption>
          Example of interactive wall: in an event, the audience participates in the event by sending bullet chatting to the big screen.
        </figcaption>
      </figure>
      <div>
        <p><b>Requirement</b></p>
        <ul>
          <li>
            <b>From the user's point of view:</b> enter the content and presentation style of the bullet chat at the event venue through a device that can access the web page, and display it on the big screen in real time.
          </li>
          <li>
            <b>From the service provider's point of view:</b> provide a page for sending bullet chat and display the received content on the big screen in the event in real time.
          </li>
        </ul>
      </div>
    </section>
    <section>
      <h2>Masking</h2>
        <p>
          In this case, computer vision and AI technologies can be used to analyze the video content and identify the previously defined "main content" of the video, generate a mask and distribute it to the client side. The browser uses CSS to render the bullet chatting without covering the defined "video body content". This kind of technique is called masking.
        </p>
        <figure>
          <img alt="Masking" src="images/bulletchat-Anti-block.png" width="600">
          <figcaption>
            [To be translated]
          </figcaption>
        </figure>
        <div>
          <p><b>Requirement</b></p>
          <ul>
            <li>
              <b>From the user's point of view:</b> the user should be able to turn on or off the masking function.
            </li>
            <li>
              <b>From the service provider's point of view:</b> computer vision and AI capabilities are needed to identify the "main content" and calculate the mask area, then return it to the client side to achieve the masking effect.
            </li>
          </ul>
        </div>
    </section>
    <section>
      <h2>Non-text bullet chatting</h2>
      <p>
        Bullet chatting can contain non-text content such as emoji and images, to express the viewer's thoughts and opinions more vividly.
      </p>
      <figure>
        <img alt="Non-text bullet chatting" src="images/bulletchat-fig.png" width="600">
        <figcaption>
          Bullet chatting containing images and emoji
        </figcaption>
      </figure>
    </section>
  </section>

  <section>
    <h2>Recommended API</h2>
    <p>Please refer <a href="api.html">Recommended API </a>.</p>
  </section>

  <section id="subtitles">
      <h2>A Gap Analysis of Bullet Chatting and Subtitles</h2>
      <section>
        <h3>Bullet Chatting vs WebVTT</h3>
        <p>[[webvtt1]] is a file format intended for marking up external text track resources, one of its typical usages is to provide captions or subtitles for video content. Bullet Chatting is also often intended for providing text descriptions of video content, so it was once considered as a subset of WebVTT, and a special format of subtitles.
        <p>However, in the <a href="#scenarios">Scenarios</a> section, we can see that the usage of Bullet Chatting is not limited to videos. For example, it's also widely used on <a href="#interaction-within-a-webpage">web page interaction</a> and <a href="#interactive-wall">interactive wall</a>, running independently as a part of the web page instead of a part of the video player.</p>
        <p>If Bullet Chatting is designed as a subset of WebVTT, then it has to follow all the rules of WebVTT, and to cue the Bullet Chatting messages as a <code>vtt</code> file in the <code>track</code> element of a <code>video</code> element. However, in the <a href="#live-streaming-interaction">live streaming interaction</a> scenario, the Bullet Chatting messages come from comments submitted by users in real-time, it's impossible to prepare a <code>vtt</code> file which contains all the Bullet Chatting messages in advance. This real-time requirement also applies to the <a href="#on-demand-video-interaction">on-demand video interaction</a> scenario. </p>
        <p>From the perspective of usage scenarios of bullet chatting and WebVTT, the two have different ways of interaction. WebVTT is used for captions or subtitles. There's basically no special interactions. The browser only displays the textual expression of the content in a fixed time period on the video timeline. The content carried by the bullet chatting is not only the textual expression of the content in the video, but also the viewer's subjective understanding of the video content. Some bullet chatting needs to have interaction, for example, the viewer might want to look at a fast scrolling bullet chatting carefully, they can hover over it to make bullet chatting stop scrolling, or click on the bullet chatting to see more information, etc. Therefore, there is a clear difference between bullet chatting and WebVTT when used interactively.</p>
        <p>In addition, the presentation of bullet chatting and the WebVTT subtitles are also very different. The subtitles of WebVTT can only be displayed in a fixed position of the video, and only one cue can be displayed at a specific time point. Bullet chatting is more flexible. It can be displayed fixedly, but is more often scrolling. The length of a WebVTT cue display is limited, but bullet chatting often has much more content than WebVTT subtitles. Therefore, for the size of the content carried, WebVTT can not meet the requirements of bullet chatting, and this is also a clear difference from WebVTT.</p>
        <p>In summary, bullet chatting and WebVTT are somewhat similar in typical usage scenarios, but there is a big difference between the functions and implementation principles behind them. Therefore, when considering the standardization of the bullet chatting, it is not designed as a subset or extension of WebVTT.</p>
      </section>

      <section>
        <h2>Bullet Chatting vs TTML</h2></h2>
        <p>
          As with WebVTT, [[ttml1]] is also a format for subtitling and captioning. A detailed comparison has been made in the above section. TTML is mainly used for video content, while Bullet Chatting is a kind of dynamic, interactive presentation for comments, which is quite different. TTML describes timed text via XML. Although it is more readable, for web developers, they are more accustomed to using JSON to describe data structures in Bullet Chatting.
        </p>
      </section>
  </section>

  <section class="appendix" id="commercial">
    <h2>Commercial operation of bullet chatting</h2>
    <p>
      Bullet Chatting has a wide range of applications in China and Japan, and mainstream video sites and their apps
      have good support and application for Bullet Chatting. The monthly activity of the relevant video websites can be
      referred to as follows (only counting monthly active users for video-sharing websites/apps):
    </p>
    <ul>
      <li>iQiyi: 575.1677 million monthly active users</li>
      <li>Tencent Video: 467.491 million monthly active users</li>
      <li>Youku: 444.829 million monthly active users</li>
      <li>Mango TV: 100.267 million monthly active users</li>
      <li>Bilibili animation: 80.652 million monthly active users</li>
      <li>Sohu video: 36.35 million monthly active users</li>
      <li>Niconico: 18.74 million monthly active users [<a
          href='https://ssl4.eir-parts.net/doc/9468/ir_material_for_fiscal_ym/64532/00.pdf'>source</a>]</li>
    </ul>
    <p>Source: <a href='https://www.analysys.cn/article/detail/20019224'>2019 Latest Mobile App TOP1000</a></p>
  </section>
</body>

</html>
